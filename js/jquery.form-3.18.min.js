/*
 * jQuery Form Plugin
 * version: 3.20 (20-NOV-2012)
 * @requires jQuery v1.5 or later
 *
 * Examples and documentation at: http://malsup.com/jquery/form/
 * Project repository: https://github.com/malsup/form
 * Dual licensed under the MIT and GPL licenses:
 *    http://malsup.github.com/mit-license.txt
 *    http://malsup.github.com/gpl-license-v2.txt
 */
(function(E){var C={};C.fileapi=E("<input type='file'/>").get(0).files!==undefined;C.formdata=window.FormData!==undefined;E.fn.ajaxSubmit=function(H){if(!this.length){D("ajaxSubmit: skipping submit process - no element selected");return this}var G,W,J,L=this;if(typeof H=="function"){H={success:H}}G=this.attr("method");W=this.attr("action");J=(typeof W==="string")?E.trim(W):"";J=J||window.location.href||"";if(J){J=(J.match(/^([^#]+)/)||[])[1]}H=E.extend(true,{url:J,success:E.ajaxSettings.success,type:G||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},H);var Q={};this.trigger("form-pre-serialize",[this,H,Q]);if(Q.veto){D("ajaxSubmit: submit vetoed via form-pre-serialize trigger");return this}if(H.beforeSerialize&&H.beforeSerialize(this,H)===false){D("ajaxSubmit: submit aborted via beforeSerialize callback");return this}var K=H.traditional;if(K===undefined){K=E.ajaxSettings.traditional}var O=[];var Z,b=this.formToArray(H.semantic,O);if(H.data){H.extraData=H.data;Z=E.param(H.data,K)}if(H.beforeSubmit&&H.beforeSubmit(b,this,H)===false){D("ajaxSubmit: submit aborted via beforeSubmit callback");return this}this.trigger("form-submit-validate",[b,this,H,Q]);if(Q.veto){D("ajaxSubmit: submit vetoed via form-submit-validate trigger");return this}var U=E.param(b,K);if(Z){U=(U?(U+"&"+Z):Z)}if(H.type.toUpperCase()=="GET"){H.url+=(H.url.indexOf("?")>=0?"&":"?")+U;H.data=null}else{H.data=U}var d=[];if(H.resetForm){d.push(function(){L.resetForm()})}if(H.clearForm){d.push(function(){L.clearForm(H.includeHidden)})}if(!H.dataType&&H.target){var I=H.success||function(){};d.push(function(e){var a=H.replaceTarget?"replaceWith":"html";E(H.target)[a](e).each(I,arguments)})}else{if(H.success){d.push(H.success)}}H.success=function(h,e,j){var g=H.context||this;for(var f=0,a=d.length;f<a;f++){d[f].apply(g,[h,e,j||L,L])}};var Y=E('input[type=file]:enabled[value!=""]',this);var M=Y.length>0;var X="multipart/form-data";var T=(L.attr("enctype")==X||L.attr("encoding")==X);var S=C.fileapi&&C.formdata;D("fileAPI :"+S);var N=(M||T)&&!S;var R;if(H.iframe!==false&&(H.iframe||N)){if(H.closeKeepAlive){E.get(H.closeKeepAlive,function(){R=c(b)})}else{R=c(b)}}else{if((M||T)&&S){R=P(b)}else{R=E.ajax(H)}}L.removeData("jqxhr").data("jqxhr",R);for(var V=0;V<O.length;V++){O[V]=null}this.trigger("form-submit-notify",[this,H]);return this;function F(h){var j=E.param(h).split("&");var e=j.length;var a={};var g,f;for(g=0;g<e;g++){f=j[g].split("=");a[decodeURIComponent(f[0])]=decodeURIComponent(f[1])}return a}function P(f){var e=new FormData();for(var g=0;g<f.length;g++){e.append(f[g].name,f[g].value)}if(H.extraData){var k=F(H.extraData);for(var l in k){if(k.hasOwnProperty(l)){e.append(l,k[l])}}}H.data=null;var j=E.extend(true,{},E.ajaxSettings,H,{contentType:false,processData:false,cache:false,type:G||"POST"});if(H.uploadProgress){j.xhr=function(){var a=jQuery.ajaxSettings.xhr();if(a.upload){a.upload.onprogress=function(o){var n=0;var i=o.loaded||o.position;var m=o.total;if(o.lengthComputable){n=Math.ceil(i/m*100)}H.uploadProgress(o,i,m,n)}}return a}}j.data=null;var h=j.beforeSend;j.beforeSend=function(i,a){a.data=e;if(h){h.call(this,i,a)}};return E.ajax(j)}function c(AI){var l=L[0],k,AE,y,AG,AB,o,t,q,r,AC,AF,w;var p=!!E.fn.prop;var AL=E.Deferred();if(E("[name=submit],[id=submit]",l).length){alert('Error: Form elements must not have name or id of "submit".');AL.reject();return AL}if(AI){for(AE=0;AE<O.length;AE++){k=E(O[AE]);if(p){k.prop("disabled",false)}else{k.removeAttr("disabled")}}}y=E.extend(true,{},E.ajaxSettings,H);y.context=y.context||y;AB="jqFormIO"+(new Date().getTime());if(y.iframeTarget){o=E(y.iframeTarget);AC=o.attr("name");if(!AC){o.attr("name",AB)}else{AB=AC}}else{o=E('<iframe name="'+AB+'" src="'+y.iframeSrc+'" />');o.css({position:"absolute",top:"-1000px",left:"-1000px"})}t=o[0];q={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(a){var g=(a==="timeout"?"timeout":"aborted");D("aborting upload... "+g);this.aborted=1;if(t.contentWindow.document.execCommand){try{t.contentWindow.document.execCommand("Stop")}catch(i){}}o.attr("src",y.iframeSrc);q.error=g;if(y.error){y.error.call(y.context,q,g,a)}if(AG){E.event.trigger("ajaxError",[q,y,g])}if(y.complete){y.complete.call(y.context,q,g)}}};AG=y.global;if(AG&&0===E.active++){E.event.trigger("ajaxStart")}if(AG){E.event.trigger("ajaxSend",[q,y])}if(y.beforeSend&&y.beforeSend.call(y.context,q,y)===false){if(y.global){E.active--}AL.reject();return AL}if(q.aborted){AL.reject();return AL}r=l.clk;if(r){AC=r.name;if(AC&&!r.disabled){y.extraData=y.extraData||{};y.extraData[AC]=r.value;if(r.type=="image"){y.extraData[AC+".x"]=l.clk_x;y.extraData[AC+".y"]=l.clk_y}}}var x=1;var u=2;function v(g){var a=g.contentWindow?g.contentWindow.document:g.contentDocument?g.contentDocument:g.document;return a}var j=E("meta[name=csrf-token]").attr("content");var h=E("meta[name=csrf-param]").attr("content");if(h&&j){y.extraData=y.extraData||{};y.extraData[h]=j}function AD(){var s=L.attr("target"),g=L.attr("action");l.setAttribute("target",AB);if(!G){l.setAttribute("method","POST")}if(g!=y.url){l.setAttribute("action",y.url)}if(!y.skipEncodingOverride&&(!G||/post/i.test(G))){L.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"})}if(y.timeout){w=setTimeout(function(){AF=true;AA(x)},y.timeout)}function AM(){try{var a=v(t).readyState;D("state = "+a);if(a&&a.toLowerCase()=="uninitialized"){setTimeout(AM,50)}}catch(n){D("Server abort: ",n," (",n.name,")");AA(u);if(w){clearTimeout(w)}w=undefined}}var i=[];try{if(y.extraData){for(var AN in y.extraData){if(y.extraData.hasOwnProperty(AN)){if(E.isPlainObject(y.extraData[AN])&&y.extraData[AN].hasOwnProperty("name")&&y.extraData[AN].hasOwnProperty("value")){i.push(E('<input type="hidden" name="'+y.extraData[AN].name+'">').attr("value",y.extraData[AN].value).appendTo(l)[0])}else{i.push(E('<input type="hidden" name="'+AN+'">').attr("value",y.extraData[AN]).appendTo(l)[0])}}}}if(!y.iframeTarget){o.appendTo("body");if(t.attachEvent){t.attachEvent("onload",AA)}else{t.addEventListener("load",AA,false)}}setTimeout(AM,15);l.submit()}finally{l.setAttribute("action",g);if(s){l.setAttribute("target",s)}else{L.removeAttr("target")}E(i).remove()}}if(y.forceSync){AD()}else{setTimeout(AD,10)}var AJ,AK,AH=50,m;function AA(AM){if(q.aborted||m){return }try{AK=v(t)}catch(AP){D("cannot access response document: ",AP);AM=u}if(AM===x&&q){q.abort("timeout");AL.reject(q,"timeout");return }else{if(AM==u&&q){q.abort("server abort");AL.reject(q,"error","server abort");return }}if(!AK||AK.location.href==y.iframeSrc){if(!AF){return }}if(t.detachEvent){t.detachEvent("onload",AA)}else{t.removeEventListener("load",AA,false)}var n="success",AO;try{if(AF){throw"timeout"}var i=y.dataType=="xml"||AK.XMLDocument||E.isXMLDoc(AK);D("isXml="+i);if(!i&&window.opera&&(AK.body===null||!AK.body.innerHTML)){if(--AH){D("requeing onLoad callback, DOM not available");setTimeout(AA,250);return }}var AQ=AK.body?AK.body:AK.documentElement;q.responseText=AQ?AQ.innerHTML:null;q.responseXML=AK.XMLDocument?AK.XMLDocument:AK;if(i){y.dataType="xml"}q.getResponseHeader=function(AT){var AS={"content-type":y.dataType};return AS[AT]};if(AQ){q.status=Number(AQ.getAttribute("status"))||q.status;q.statusText=AQ.getAttribute("statusText")||q.statusText}var a=(y.dataType||"").toLowerCase();var AN=/(json|script|text)/.test(a);if(AN||y.textarea){var s=AK.getElementsByTagName("textarea")[0];if(s){q.responseText=s.value;q.status=Number(s.getAttribute("status"))||q.status;q.statusText=s.getAttribute("statusText")||q.statusText}else{if(AN){var g=AK.getElementsByTagName("pre")[0];var AR=AK.getElementsByTagName("body")[0];if(g){q.responseText=g.textContent?g.textContent:g.innerText}else{if(AR){q.responseText=AR.textContent?AR.textContent:AR.innerText}}}}}else{if(a=="xml"&&!q.responseXML&&q.responseText){q.responseXML=z(q.responseText)}}try{AJ=e(q,a,y)}catch(AM){n="parsererror";q.error=AO=(AM||n)}}catch(AM){D("error caught: ",AM);n="error";q.error=AO=(AM||n)}if(q.aborted){D("upload aborted");n=null}if(q.status){n=(q.status>=200&&q.status<300||q.status===304)?"success":"error"}if(n==="success"){if(y.success){y.success.call(y.context,AJ,"success",q)}AL.resolve(q.responseText,"success",q);if(AG){E.event.trigger("ajaxSuccess",[q,y])}}else{if(n){if(AO===undefined){AO=q.statusText}if(y.error){y.error.call(y.context,q,n,AO)}AL.reject(q,"error",AO);if(AG){E.event.trigger("ajaxError",[q,y,AO])}}}if(AG){E.event.trigger("ajaxComplete",[q,y])}if(AG&&!--E.active){E.event.trigger("ajaxStop")}if(y.complete){y.complete.call(y.context,q,n)}m=true;if(y.timeout){clearTimeout(w)}setTimeout(function(){if(!y.iframeTarget){o.remove()}q.responseXML=null},100)}var z=E.parseXML||function(a,g){if(window.ActiveXObject){g=new ActiveXObject("Microsoft.XMLDOM");g.async="false";g.loadXML(a)}else{g=(new DOMParser()).parseFromString(a,"text/xml")}return(g&&g.documentElement&&g.documentElement.nodeName!="parsererror")?g:null};var f=E.parseJSON||function(a){return window["eval"]("("+a+")")};var e=function(AN,n,i){var g=AN.getResponseHeader("content-type")||"",a=n==="xml"||!n&&g.indexOf("xml")>=0,AM=a?AN.responseXML:AN.responseText;if(a&&AM.documentElement.nodeName==="parsererror"){if(E.error){E.error("parsererror")}}if(i&&i.dataFilter){AM=i.dataFilter(AM,n)}if(typeof AM==="string"){if(n==="json"||!n&&g.indexOf("json")>=0){AM=f(AM)}else{if(n==="script"||!n&&g.indexOf("javascript")>=0){E.globalEval(AM)}}}return AM};return AL}};E.fn.ajaxForm=function(F){F=F||{};F.delegation=F.delegation&&E.isFunction(E.fn.on);if(!F.delegation&&this.length===0){var G={s:this.selector,c:this.context};if(!E.isReady&&G.s){D("DOM not ready, queuing ajaxForm");E(function(){E(G.s,G.c).ajaxForm(F)});return this}D("terminating; zero elements found by selector"+(E.isReady?"":" (DOM not ready)"));return this}if(F.delegation){E(document).off("submit.form-plugin",this.selector,B).off("click.form-plugin",this.selector,A).on("submit.form-plugin",this.selector,F,B).on("click.form-plugin",this.selector,F,A);return this}return this.ajaxFormUnbind().bind("submit.form-plugin",F,B).bind("click.form-plugin",F,A)};function B(G){var F=G.data;if(!G.isDefaultPrevented()){G.preventDefault();E(this).ajaxSubmit(F)}}function A(J){var I=J.target;var G=E(I);if(!(G.is("[type=submit],[type=image]"))){var F=G.closest("[type=submit]");if(F.length===0){return }I=F[0]}var H=this;H.clk=I;if(I.type=="image"){if(J.offsetX!==undefined){H.clk_x=J.offsetX;H.clk_y=J.offsetY}else{if(typeof E.fn.offset=="function"){var K=G.offset();H.clk_x=J.pageX-K.left;H.clk_y=J.pageY-K.top}else{H.clk_x=J.pageX-I.offsetLeft;H.clk_y=J.pageY-I.offsetTop}}}setTimeout(function(){H.clk=H.clk_x=H.clk_y=null},100)}E.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")};E.fn.formToArray=function(S,F){var R=[];if(this.length===0){return R}var I=this[0];var L=S?I.getElementsByTagName("*"):I.elements;if(!L){return R}var N,M,K,T,J,P,H;for(N=0,P=L.length;N<P;N++){J=L[N];K=J.name;if(!K){continue}if(S&&I.clk&&J.type=="image"){if(!J.disabled&&I.clk==J){R.push({name:K,value:E(J).val(),type:J.type});R.push({name:K+".x",value:I.clk_x},{name:K+".y",value:I.clk_y})}continue}T=E.fieldValue(J,true);if(T&&T.constructor==Array){if(F){F.push(J)}for(M=0,H=T.length;M<H;M++){R.push({name:K,value:T[M]})}}else{if(C.fileapi&&J.type=="file"&&!J.disabled){if(F){F.push(J)}var G=J.files;if(G.length){for(M=0;M<G.length;M++){R.push({name:K,value:G[M],type:J.type})}}else{R.push({name:K,value:"",type:J.type})}}else{if(T!==null&&typeof T!="undefined"){if(F){F.push(J)}R.push({name:K,value:T,type:J.type,required:J.required})}}}}if(!S&&I.clk){var O=E(I.clk),Q=O[0];K=Q.name;if(K&&!Q.disabled&&Q.type=="image"){R.push({name:K,value:O.val()});R.push({name:K+".x",value:I.clk_x},{name:K+".y",value:I.clk_y})}}return R};E.fn.formSerialize=function(F){return E.param(this.formToArray(F))};E.fn.fieldSerialize=function(G){var F=[];this.each(function(){var K=this.name;if(!K){return }var I=E.fieldValue(this,G);if(I&&I.constructor==Array){for(var J=0,H=I.length;J<H;J++){F.push({name:K,value:I[J]})}}else{if(I!==null&&typeof I!="undefined"){F.push({name:this.name,value:I})}}});return E.param(F)};E.fn.fieldValue=function(K){for(var J=[],H=0,F=this.length;H<F;H++){var I=this[H];var G=E.fieldValue(I,K);if(G===null||typeof G=="undefined"||(G.constructor==Array&&!G.length)){continue}if(G.constructor==Array){E.merge(J,G)}else{J.push(G)}}return J};E.fieldValue=function(F,L){var H=F.name,Q=F.type,R=F.tagName.toLowerCase();if(L===undefined){L=true}if(L&&(!H||F.disabled||Q=="reset"||Q=="button"||(Q=="checkbox"||Q=="radio")&&!F.checked||(Q=="submit"||Q=="image")&&F.form&&F.form.clk!=F||R=="select"&&F.selectedIndex==-1)){return null}if(R=="select"){var M=F.selectedIndex;if(M<0){return null}var O=[],G=F.options;var J=(Q=="select-one");var N=(J?M+1:G.length);for(var I=(J?M:0);I<N;I++){var K=G[I];if(K.selected){var P=K.value;if(!P){P=(K.attributes&&K.attributes.value&&!(K.attributes.value.specified))?K.text:K.value}if(J){return P}O.push(P)}}return O}return E(F).val()};E.fn.clearForm=function(F){return this.each(function(){E("input,select,textarea",this).clearFields(F)})};E.fn.clearFields=E.fn.clearInputs=function(F){var G=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var I=this.type,H=this.tagName.toLowerCase();if(G.test(I)||H=="textarea"){this.value=""}else{if(I=="checkbox"||I=="radio"){this.checked=false}else{if(H=="select"){this.selectedIndex=-1}else{if(F){if((F===true&&/hidden/.test(I))||(typeof F=="string"&&E(this).is(F))){this.value=""}}}}}})};E.fn.resetForm=function(){return this.each(function(){if(typeof this.reset=="function"||(typeof this.reset=="object"&&!this.reset.nodeType)){this.reset()}})};E.fn.enable=function(F){if(F===undefined){F=true}return this.each(function(){this.disabled=!F})};E.fn.selected=function(F){if(F===undefined){F=true}return this.each(function(){var G=this.type;if(G=="checkbox"||G=="radio"){this.checked=F}else{if(this.tagName.toLowerCase()=="option"){var H=E(this).parent("select");if(F&&H[0]&&H[0].type=="select-one"){H.find("option").selected(false)}this.selected=F}}})};E.fn.ajaxSubmit.debug=false;function D(){if(!E.fn.ajaxSubmit.debug){return }var F="[jquery.form] "+Array.prototype.join.call(arguments,"");if(window.console&&window.console.log){window.console.log(F)}else{if(window.opera&&window.opera.postError){window.opera.postError(F)}}}})(jQuery);